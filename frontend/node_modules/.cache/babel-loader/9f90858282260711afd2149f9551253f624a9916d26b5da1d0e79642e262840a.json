{"ast":null,"code":"var _jsxFileName = \"/home/ubuntu/vicky/I2I projects/Inventory management/frontend/src/components/ProtectedRoute.tsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { Navigate, useLocation } from 'react-router-dom';\nimport { useQuery } from 'react-query';\nimport apiService from '../services/api';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst ProtectedRoute = ({\n  children,\n  requiredPermissions = []\n}) => {\n  _s();\n  const location = useLocation();\n  const [isAuthenticated, setIsAuthenticated] = useState(null);\n\n  // Check if user is authenticated\n  const {\n    data: user,\n    isLoading,\n    error\n  } = useQuery(['currentUser'], apiService.users.getCurrentUser, {\n    retry: false,\n    onSuccess: data => {\n      setIsAuthenticated(true);\n\n      // Check if user has required permissions\n      if (requiredPermissions.length > 0) {\n        const hasAllPermissions = requiredPermissions.every(permission => data.hasOwnProperty(permission) && data[permission]);\n        if (!hasAllPermissions) {\n          setIsAuthenticated(false);\n        }\n      }\n    },\n    onError: () => {\n      setIsAuthenticated(false);\n    }\n  });\n  useEffect(() => {\n    const token = localStorage.getItem('access_token');\n    if (!token) {\n      setIsAuthenticated(false);\n    }\n  }, []);\n\n  // Show loading spinner while checking authentication\n  if (isLoading || isAuthenticated === null) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"min-h-screen flex items-center justify-center bg-gray-50\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-4 text-gray-600\",\n          children: \"Loading...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 7\n    }, this);\n  }\n\n  // Redirect to login if not authenticated\n  if (!isAuthenticated) {\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/login\",\n      state: {\n        from: location\n      },\n      replace: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 12\n    }, this);\n  }\n\n  // Show access denied if user doesn't have required permissions\n  if (requiredPermissions.length > 0 && user) {\n    const hasAllPermissions = requiredPermissions.every(permission => user.hasOwnProperty(permission) && user[permission]);\n    if (!hasAllPermissions) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"min-h-screen flex items-center justify-center bg-gray-50\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mx-auto h-16 w-16 bg-red-100 rounded-full flex items-center justify-center\",\n            children: /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"h-8 w-8 text-red-600\",\n              fill: \"none\",\n              viewBox: \"0 0 24 24\",\n              stroke: \"currentColor\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: 2,\n                d: \"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 81,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 80,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 79,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"mt-6 text-2xl font-bold text-gray-900\",\n            children: \"Access Denied\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"mt-2 text-gray-600\",\n            children: \"You don't have permission to access this page.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-6\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => window.history.back(),\n              className: \"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700\",\n              children: \"Go Back\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 89,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }, this);\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: children\n  }, void 0, false);\n};\n_s(ProtectedRoute, \"nEu0capEOpE3/mRXxPRY2DsfEmY=\", false, function () {\n  return [useLocation, useQuery];\n});\n_c = ProtectedRoute;\nexport default ProtectedRoute;\nvar _c;\n$RefreshReg$(_c, \"ProtectedRoute\");","map":{"version":3,"names":["React","useEffect","useState","Navigate","useLocation","useQuery","apiService","jsxDEV","_jsxDEV","Fragment","_Fragment","ProtectedRoute","children","requiredPermissions","_s","location","isAuthenticated","setIsAuthenticated","data","user","isLoading","error","users","getCurrentUser","retry","onSuccess","length","hasAllPermissions","every","permission","hasOwnProperty","onError","token","localStorage","getItem","className","fileName","_jsxFileName","lineNumber","columnNumber","to","state","from","replace","fill","viewBox","stroke","strokeLinecap","strokeLinejoin","strokeWidth","d","onClick","window","history","back","_c","$RefreshReg$"],"sources":["/home/ubuntu/vicky/I2I projects/Inventory management/frontend/src/components/ProtectedRoute.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { Navigate, useLocation } from 'react-router-dom';\nimport { useQuery } from 'react-query';\nimport apiService from '../services/api';\nimport { UserWithPermissions } from '../types';\n\ninterface ProtectedRouteProps {\n  children: React.ReactNode;\n  requiredPermissions?: string[];\n}\n\nconst ProtectedRoute: React.FC<ProtectedRouteProps> = ({ \n  children, \n  requiredPermissions = [] \n}) => {\n  const location = useLocation();\n  const [isAuthenticated, setIsAuthenticated] = useState<boolean | null>(null);\n\n  // Check if user is authenticated\n  const { data: user, isLoading, error } = useQuery(\n    ['currentUser'],\n    apiService.users.getCurrentUser,\n    {\n      retry: false,\n      onSuccess: (data: UserWithPermissions) => {\n        setIsAuthenticated(true);\n        \n        // Check if user has required permissions\n        if (requiredPermissions.length > 0) {\n          const hasAllPermissions = requiredPermissions.every(permission =>\n            data.hasOwnProperty(permission) && (data as any)[permission]\n          );\n          \n          if (!hasAllPermissions) {\n            setIsAuthenticated(false);\n          }\n        }\n      },\n      onError: () => {\n        setIsAuthenticated(false);\n      },\n    }\n  );\n\n  useEffect(() => {\n    const token = localStorage.getItem('access_token');\n    if (!token) {\n      setIsAuthenticated(false);\n    }\n  }, []);\n\n  // Show loading spinner while checking authentication\n  if (isLoading || isAuthenticated === null) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto\"></div>\n          <p className=\"mt-4 text-gray-600\">Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  // Redirect to login if not authenticated\n  if (!isAuthenticated) {\n    return <Navigate to=\"/login\" state={{ from: location }} replace />;\n  }\n\n  // Show access denied if user doesn't have required permissions\n  if (requiredPermissions.length > 0 && user) {\n    const hasAllPermissions = requiredPermissions.every(permission =>\n      user.hasOwnProperty(permission) && (user as any)[permission]\n    );\n    \n    if (!hasAllPermissions) {\n      return (\n        <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\n          <div className=\"text-center\">\n            <div className=\"mx-auto h-16 w-16 bg-red-100 rounded-full flex items-center justify-center\">\n              <svg className=\"h-8 w-8 text-red-600\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\n              </svg>\n            </div>\n            <h2 className=\"mt-6 text-2xl font-bold text-gray-900\">Access Denied</h2>\n            <p className=\"mt-2 text-gray-600\">\n              You don't have permission to access this page.\n            </p>\n            <div className=\"mt-6\">\n              <button\n                onClick={() => window.history.back()}\n                className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700\"\n              >\n                Go Back\n              </button>\n            </div>\n          </div>\n        </div>\n      );\n    }\n  }\n\n  return <>{children}</>;\n};\n\nexport default ProtectedRoute; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}